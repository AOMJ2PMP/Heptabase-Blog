{"ast":null,"code":"var _jsxFileName = \"/Users/jiangzilong/\\u5B66\\u4E60/minpg/Heptabase-Blog/src/page/Post.js\",\n  _s = $RefreshSig$();\n// import React from 'react';\nimport React, { useState, useEffect, useRef } from 'react';\nimport { BrowserRouter as Router, Routes, Route, Link, useParams } from 'react-router-dom';\nimport Nav from '../components/Nav';\nimport '../index.css';\n// import { Link } from 'react-router-dom';\n\nimport Home from './Home';\nimport Empty from './404';\nimport About from './About';\nimport 'github-markdown-css';\n\n// import ReactMarkdown from 'https://esm.sh/react-markdown@7'\n// import remarkGfm from 'https://esm.sh/remark-gfm@3'\n\nimport ReactMarkdown from 'react-markdown';\nimport remarkGfm from 'remark-gfm';\nimport { getHeptabaseData, getClearCard, getClearImag } from '../constantFunction';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Post() {\n  _s();\n  let [isLoading, setLoadingState] = useState(true);\n  let [card, setCard] = useState('card');\n  let [heptabase_data, setHeptabaseData] = useState('heptabase_data');\n  let {\n    slug\n  } = useParams();\n  const post = useRef(null);\n  console.log(post);\n  if (post.current != null) {\n    console.log(post.current.getelementsbytagname('img'));\n  }\n  const setContent = id => {\n    console.log('setContent');\n    let heptabase_blog_data;\n    getHeptabaseData.then(res => {\n      heptabase_blog_data = res.data;\n      console.log(res);\n      //获取 URL 中的文章 ID\n\n      console.log('Post setContent for:');\n      for (let i = 0; i < heptabase_blog_data.cards.length; i++) {\n        if (heptabase_blog_data.cards[i]['id'] == id) {\n          // 处理内容中的图片\n          heptabase_blog_data.cards[i] = getClearImag(heptabase_blog_data.cards[i]);\n          console.log('getClearImag done');\n          // 处理内容中的链接\n          let new_card = getClearCard(heptabase_blog_data.cards[i], heptabase_blog_data.cards);\n          heptabase_blog_data.cards[i] = new_card['card'];\n          console.log('backLinks:');\n          console.log(new_card['backLinks']);\n          console.log(new_card);\n\n          // this.setState({ content: heptabase_blog_data.cards[i]['content'], backLinks: new_card['backLinks'], isLoading: false, old_post_id: heptabase_blog_data.cards[i]['id'] })\n          setHeptabaseData(heptabase_blog_data);\n          setCard(new_card);\n          setLoadingState(false);\n          break;\n        }\n      }\n\n      // 404\n    });\n  };\n\n  const handleBackLinkClick = id => {\n    console.log('handleBackLinkClick');\n    console.log(id);\n    if (id != this.state.old_post_id) {\n      this.setState({\n        new_post_id: id\n      });\n    }\n\n    // console.log(event);\n  };\n\n  // setContent(slug)\n\n  useEffect(() => {\n    console.log('useEffect');\n\n    //设置页面内容\n    console.log(card);\n    if (card != 'card') {\n      if (card['card']['id'] != slug) {\n        setContent(slug);\n      }\n    }\n  });\n  if (isLoading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      onClick: setContent(slug),\n      children: \"Loaindg..\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 16\n    }, this);\n  } else {\n    console.log(slug);\n    console.log(card);\n\n    // md 转 HTML\n    // var showdown = require('showdown'),\n    //     converter = new showdown.Converter(),\n    //     html = converter.makeHtml(card['card']['content']);\n    // console.log(html);\n    // setCard(slug)\n\n    // 反向链接\n    let backLinksBox = /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"markdown-body backLinks\",\n      children: [/*#__PURE__*/_jsxDEV(\"header\", {\n        children: \"Links to this page\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        children: \"null\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 28\n    }, this);\n    console.log(card['backLinks']);\n    if (card['backLinks'].length > 0) {\n      let backLinks = card['backLinks'].map(backLink => /*#__PURE__*/_jsxDEV(\"li\", {\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          to: {\n            pathname: '/post/' + backLink.id\n          },\n          children: backLink.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 21\n        }, this)\n      }, backLink.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 17\n      }, this));\n      backLinksBox = /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"markdown-body backLinks\",\n        children: [/*#__PURE__*/_jsxDEV(\"header\", {\n          children: \"Links to this page\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n          children: backLinks\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 28\n      }, this);\n    }\n    const mm = `\n        \n        A paragraph with *emphasis* and **strong importance**.\n\n        > A block quote with ~strikethrough~ and a URL: https://reactjs.org.\n        \n        * Lists\n        * [ ] todo\n        * [x] done\n        ~~this is~~\n\n        A table:\n        \n        | a | b |\n        | - | - |\n\n\n        `;\n    window.scrollTo(0, 0);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(Nav, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: post,\n          className: \"markdown-body container\",\n          children: [/*#__PURE__*/_jsxDEV(\"article\", {\n            children: /*#__PURE__*/_jsxDEV(ReactMarkdown, {\n              children: card['card']['content'],\n              remarkPlugins: [remarkGfm, {\n                singleTilde: false\n              }]\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 175,\n              columnNumber: 30\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 175,\n            columnNumber: 21\n          }, this), backLinksBox]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 16\n    }, this);\n  }\n\n  // return (\n  //     <div>Post</div>\n  // )\n}\n_s(Post, \"9v4ml0kjubMkd4nkOv5NVAVUdaM=\", false, function () {\n  return [useParams];\n});\n_c = Post;\nexport default Post;\nvar _c;\n$RefreshReg$(_c, \"Post\");","map":{"version":3,"names":["React","useState","useEffect","useRef","BrowserRouter","Router","Routes","Route","Link","useParams","Nav","Home","Empty","About","ReactMarkdown","remarkGfm","getHeptabaseData","getClearCard","getClearImag","Post","isLoading","setLoadingState","card","setCard","heptabase_data","setHeptabaseData","slug","post","console","log","current","getelementsbytagname","setContent","id","heptabase_blog_data","then","res","data","i","cards","length","new_card","handleBackLinkClick","state","old_post_id","setState","new_post_id","backLinksBox","backLinks","map","backLink","pathname","title","mm","window","scrollTo","singleTilde"],"sources":["/Users/jiangzilong/学习/minpg/Heptabase-Blog/src/page/Post.js"],"sourcesContent":["// import React from 'react';\nimport React, { useState, useEffect,useRef } from 'react';\nimport { BrowserRouter as Router, Routes, Route, Link, useParams } from 'react-router-dom';\n\nimport Nav from '../components/Nav';\nimport '../index.css'\n// import { Link } from 'react-router-dom';\n\nimport Home from './Home';\nimport Empty from './404';\nimport About from './About';\n\nimport 'github-markdown-css'\n\n// import ReactMarkdown from 'https://esm.sh/react-markdown@7'\n// import remarkGfm from 'https://esm.sh/remark-gfm@3'\n\nimport ReactMarkdown from 'react-markdown'\nimport remarkGfm from 'remark-gfm'\n\n\n\nimport { getHeptabaseData, getClearCard, getClearImag } from '../constantFunction'\n\n\nfunction Post() {\n    let [isLoading, setLoadingState] = useState(true)\n    let [card, setCard] = useState('card');\n    let [heptabase_data, setHeptabaseData] = useState('heptabase_data');\n    let { slug } = useParams();\n\n    const post = useRef(null);\n    console.log(post);\n    if(post.current!=null){\n        console.log(post.current.getelementsbytagname('img'));\n    }\n\n    const setContent = (id) => {\n        console.log('setContent');\n        let heptabase_blog_data\n        getHeptabaseData.then((res) => {\n            heptabase_blog_data = res.data\n            console.log(res);\n            //获取 URL 中的文章 ID\n\n            console.log('Post setContent for:');\n            for (let i = 0; i < heptabase_blog_data.cards.length; i++) {\n\n                if (heptabase_blog_data.cards[i]['id'] == id) {\n\n                    // 处理内容中的图片\n                    heptabase_blog_data.cards[i] = getClearImag(heptabase_blog_data.cards[i])\n                    console.log('getClearImag done');\n                    // 处理内容中的链接\n                    let new_card = getClearCard(heptabase_blog_data.cards[i], heptabase_blog_data.cards)\n                    heptabase_blog_data.cards[i] = new_card['card']\n\n                    console.log('backLinks:');\n                    console.log(new_card['backLinks']);\n                    console.log(new_card);\n\n                    // this.setState({ content: heptabase_blog_data.cards[i]['content'], backLinks: new_card['backLinks'], isLoading: false, old_post_id: heptabase_blog_data.cards[i]['id'] })\n                    setHeptabaseData(heptabase_blog_data)\n                    setCard(new_card)\n                    setLoadingState(false)\n                    break;\n                }\n            }\n\n            // 404\n        })\n\n    }\n\n    const handleBackLinkClick = (id) => {\n        console.log('handleBackLinkClick');\n        console.log(id);\n\n        if (id != this.state.old_post_id) {\n            this.setState({\n                new_post_id: id\n            })\n        }\n\n        // console.log(event);\n    }\n\n    // setContent(slug)\n\n    useEffect(() => {\n\n        console.log('useEffect');\n\n        //设置页面内容\n        console.log(card);\n        if (card != 'card') {\n            if (card['card']['id'] != slug) {\n                setContent(slug)\n            }\n        }\n\n    });\n\n\n    if (isLoading) {\n        return <div onClick={setContent(slug)}>Loaindg..</div>\n    } else {\n        console.log(slug);\n        console.log(card);\n\n        // md 转 HTML\n        // var showdown = require('showdown'),\n        //     converter = new showdown.Converter(),\n        //     html = converter.makeHtml(card['card']['content']);\n        // console.log(html);\n        // setCard(slug)\n\n        // 反向链接\n        let backLinksBox = <div className='markdown-body backLinks'>\n            <header>Links to this page</header>\n            <ul>\n                null\n            </ul>\n        </div>\n\n        console.log(card['backLinks']);\n        if (card['backLinks'].length > 0) {\n            let backLinks = card['backLinks'].map((backLink) =>\n                <li key={backLink.id} >\n                    <Link to={{ pathname: '/post/' + backLink.id }} >\n                        {/* <span onClick={this.handleBackLinkClick.bind(Event, backLink.id)}> */}\n                        {backLink.title}\n                        {/* </span> */}\n                    </Link>\n                </li>\n            )\n\n            backLinksBox = <div className='markdown-body backLinks'>\n                <header>Links to this page</header>\n                <ul>\n                    {backLinks}\n                </ul>\n            </div>\n        }\n\n        const mm = `\n        \n        A paragraph with *emphasis* and **strong importance**.\n\n        > A block quote with ~strikethrough~ and a URL: https://reactjs.org.\n        \n        * Lists\n        * [ ] todo\n        * [x] done\n        ~~this is~~\n\n        A table:\n        \n        | a | b |\n        | - | - |\n\n\n        `\n        window.scrollTo(0, 0);\n\n        return <div>\n\n            <div>\n                <Nav />\n                <div ref={post} className='markdown-body container'>\n\n                    {/* <article dangerouslySetInnerHTML={{ __html: html }}></article>\n                    {backLinksBox} */}\n\n                    <article><ReactMarkdown children={card['card']['content']} remarkPlugins={[remarkGfm, { singleTilde: false }]} /></article>\n                    {backLinksBox}\n\n                </div>\n\n            </div>\n        </div>;\n    }\n\n\n    // return (\n    //     <div>Post</div>\n    // )\n}\n\nexport default Post;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"var _jsxFileName = \"/Users/jiangzilong/\\u5B66\\u4E60/minpg/Heptabase-Blog/src/page/Post.js\",\n  _s = $RefreshSig$();\n// import React from 'react';\nimport React, { useState, useEffect } from 'react';\nimport { BrowserRouter as Router, Routes, Route, Link } from 'react-router-dom';\nimport Nav from '../components/Nav';\nimport '../index.css';\n// import { Link } from 'react-router-dom';\n\nimport Home from './Home';\nimport Empty from './404';\nimport About from './About';\nimport { getHeptabaseData, getClearCard, getClearImag } from '../constantFunction';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst TypeChnage = props => {\n  _s();\n  console.log(props.type, 'ssssssssssssssssssssssss');\n  const init = () => {\n    console.log('cccccccccc');\n  };\n  useEffect(() => {\n    props.init();\n  }, [props.type]);\n  return null;\n};\n// -----------------------------------\n// ©著作权归作者所有：来自51CTO博客作者lllomh的原创作品，请联系作者获取转载授权，否则将追究法律责任\n// React监控url参数值变化后执行(componentWillReceiveProps最佳替代方案)\n// https://blog.51cto.com/lllomh/5735709\n_s(TypeChnage, \"OD7bBpZva5O2jO+Puf00hKivP7c=\");\n_c = TypeChnage;\nclass Post extends React.Component {\n  constructor(props) {\n    super(props);\n    this.setContent = id => {\n      let heptabase_blog_data;\n      getHeptabaseData.then(res => {\n        heptabase_blog_data = res.data;\n        console.log(res);\n        //获取 URL 中的文章 ID\n\n        console.log('Post setContent for:');\n        for (let i = 0; i < heptabase_blog_data.cards.length; i++) {\n          if (heptabase_blog_data.cards[i]['id'] == id) {\n            // 处理内容中的图片\n            heptabase_blog_data.cards[i] = getClearImag(heptabase_blog_data.cards[i]);\n            console.log('getClearImag done');\n            // 处理内容中的链接\n            let new_card = getClearCard(heptabase_blog_data.cards[i], heptabase_blog_data.cards);\n            heptabase_blog_data.cards[i] = new_card['card'];\n            console.log('backLinks:');\n            console.log(new_card['backLinks']);\n            this.setState({\n              content: heptabase_blog_data.cards[i]['content'],\n              backLinks: new_card['backLinks'],\n              isLoading: false\n            });\n            break;\n          }\n        }\n      });\n    };\n    this.handleBackLinkClick = id => {\n      console.log('handleBackLinkClick');\n      console.log(id);\n      this.setContent(id);\n      // console.log(event);\n    };\n    this.state = {\n      content: '',\n      backLinks: [],\n      isLoading: true\n    };\n  }\n  UNSAFE_componentWillMount() {\n    //console.log(this.props.location)//传递过来的所有参数\n    // console.log(this.props.location.state.key)//val值\n\n    console.log('Post UNSAFE_componentWillMount:');\n    console.log(this.props);\n    console.log(window.location);\n    let post_id = window.location.search.replace('?id=', '');\n    this.setContent(post_id);\n\n    // this.props.history.listen = () => {\n    //     console.log(this.props.history);\n    // }\n  }\n\n  componentDidUpdate() {\n    console.log('componentDidUpdate');\n  }\n  UNSAFE_componentWillReceiveProps() {\n    console.log('Post UNSAFE_componentWillReceiveProps');\n  }\n  render() {\n    console.log('Post render');\n    // console.log(this.state.backLinks);\n\n    if (this.state.isLoading) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"Loaidng...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 20\n      }, this);\n    } else {\n      let card_text = this.state.content;\n      var showdown = require('showdown'),\n        converter = new showdown.Converter(),\n        text = card_text,\n        html = converter.makeHtml(text);\n      // console.log(html);\n\n      // 反向链接\n      let backLinksBox = /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 32\n      }, this);\n      if (this.state.backLinks.length > 0) {\n        let backLinks = this.state.backLinks.map(backLink => /*#__PURE__*/_jsxDEV(\"li\", {\n          children: /*#__PURE__*/_jsxDEV(Link, {\n            to: {\n              pathname: '/post',\n              search: '?id=' + backLink.id\n            },\n            children: backLink.title\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 25\n          }, this)\n        }, backLink.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 21\n        }, this));\n        backLinksBox = /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"backLinks\",\n          children: [/*#__PURE__*/_jsxDEV(\"header\", {\n            children: \"Link to this page\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n            children: backLinks\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 32\n        }, this);\n      }\n\n      // 滚动到顶部\n      window.scrollTo(0, 0);\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(Nav, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"container\",\n          children: [/*#__PURE__*/_jsxDEV(\"article\", {\n            dangerouslySetInnerHTML: {\n              __html: html\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 25\n          }, this), backLinksBox]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(TypeChnage, {\n          type: 'type',\n          init: () => this.init()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Routes, {\n          children: [/*#__PURE__*/_jsxDEV(Route, {\n            path: \"/post/:id/*\",\n            element: /*#__PURE__*/_jsxDEV(Post, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 155,\n              columnNumber: 60\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/post/\",\n            element: /*#__PURE__*/_jsxDEV(Post, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 157,\n              columnNumber: 55\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 157,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 17\n      }, this);\n    }\n  }\n}\nexport default Post;\nvar _c;\n$RefreshReg$(_c, \"TypeChnage\");","map":{"version":3,"names":["React","useState","useEffect","BrowserRouter","Router","Routes","Route","Link","Nav","Home","Empty","About","getHeptabaseData","getClearCard","getClearImag","TypeChnage","props","console","log","type","init","Post","Component","constructor","setContent","id","heptabase_blog_data","then","res","data","i","cards","length","new_card","setState","content","backLinks","isLoading","handleBackLinkClick","state","UNSAFE_componentWillMount","window","location","post_id","search","replace","componentDidUpdate","UNSAFE_componentWillReceiveProps","render","card_text","showdown","require","converter","Converter","text","html","makeHtml","backLinksBox","map","backLink","pathname","title","scrollTo","__html"],"sources":["/Users/jiangzilong/学习/minpg/Heptabase-Blog/src/page/Post.js"],"sourcesContent":["// import React from 'react';\nimport React, { useState, useEffect } from 'react';\nimport { BrowserRouter as Router, Routes, Route, Link } from 'react-router-dom';\nimport Nav from '../components/Nav';\nimport '../index.css'\n// import { Link } from 'react-router-dom';\n\nimport Home from './Home';\nimport Empty from './404';\nimport About from './About';\n\nimport { getHeptabaseData, getClearCard, getClearImag } from '../constantFunction'\n\n\nconst TypeChnage = (props) => {\n    console.log(props.type, 'ssssssssssssssssssssssss')\n    const init = () => {\n        console.log('cccccccccc')\n    };\n    useEffect(() => {\n        props.init();\n    }, [props.type]);\n    return null;\n}\n// -----------------------------------\n// ©著作权归作者所有：来自51CTO博客作者lllomh的原创作品，请联系作者获取转载授权，否则将追究法律责任\n// React监控url参数值变化后执行(componentWillReceiveProps最佳替代方案)\n// https://blog.51cto.com/lllomh/5735709\n\nclass Post extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = { content: '', backLinks: [], isLoading: true };\n    }\n\n    UNSAFE_componentWillMount() {\n        //console.log(this.props.location)//传递过来的所有参数\n        // console.log(this.props.location.state.key)//val值\n\n        console.log('Post UNSAFE_componentWillMount:');\n        console.log(this.props);\n        console.log(window.location);\n        let post_id = window.location.search.replace('?id=', '')\n        this.setContent(post_id)\n\n        // this.props.history.listen = () => {\n        //     console.log(this.props.history);\n        // }\n\n    }\n\n    componentDidUpdate() {\n        console.log('componentDidUpdate');\n    }\n\n    UNSAFE_componentWillReceiveProps() {\n        console.log('Post UNSAFE_componentWillReceiveProps');\n    }\n\n    setContent = (id) => {\n\n        let heptabase_blog_data\n        getHeptabaseData.then((res) => {\n            heptabase_blog_data = res.data\n            console.log(res);\n            //获取 URL 中的文章 ID\n\n            console.log('Post setContent for:');\n            for (let i = 0; i < heptabase_blog_data.cards.length; i++) {\n\n                if (heptabase_blog_data.cards[i]['id'] == id) {\n\n                    // 处理内容中的图片\n                    heptabase_blog_data.cards[i] = getClearImag(heptabase_blog_data.cards[i])\n                    console.log('getClearImag done');\n                    // 处理内容中的链接\n                    let new_card = getClearCard(heptabase_blog_data.cards[i], heptabase_blog_data.cards)\n                    heptabase_blog_data.cards[i] = new_card['card']\n\n                    console.log('backLinks:');\n                    console.log(new_card['backLinks']);\n\n                    this.setState({ content: heptabase_blog_data.cards[i]['content'], backLinks: new_card['backLinks'], isLoading: false })\n                    break;\n                }\n            }\n        })\n\n    }\n\n    handleBackLinkClick = (id) => {\n        console.log('handleBackLinkClick');\n        console.log(id);\n        this.setContent(id)\n        // console.log(event);\n    }\n\n    render() {\n\n\n        console.log('Post render');\n        // console.log(this.state.backLinks);\n\n        if (this.state.isLoading) {\n            return <div>Loaidng...</div>\n        } else {\n            let card_text = this.state.content\n\n            var showdown = require('showdown'),\n                converter = new showdown.Converter(),\n                text = card_text,\n                html = converter.makeHtml(text);\n            // console.log(html);\n\n            // 反向链接\n            let backLinksBox = <div></div>\n            if (this.state.backLinks.length > 0) {\n                let backLinks = this.state.backLinks.map((backLink) =>\n                    <li key={backLink.id} >\n                        <Link to={{ pathname: '/post', search: '?id=' + backLink.id }} >\n                            {/* <span onClick={this.handleBackLinkClick.bind(Event,backLink.id)}> */}\n                            {backLink.title}\n                            {/* </span> */}\n                        </Link>\n                    </li>\n                )\n\n                backLinksBox = <div className='backLinks'>\n                    <header>Link to this page</header>\n                    <ul>\n                        {backLinks}\n                    </ul>\n                </div>\n            }\n\n\n            // 滚动到顶部\n            window.scrollTo(0, 0);\n\n            return (\n                <div>\n                    <Nav />\n                    <div className='container'>\n\n                        <article dangerouslySetInnerHTML={{ __html: html }}></article>\n                        {backLinksBox}\n\n                    </div>\n\n                    <TypeChnage type={'type'} init={() => this.init()} />\n\n\n                    <Routes >\n                        <Route path=\"/post/:id/*\" element={<Post />} />\n                        {/* <Route exact path=\"/post?id\" element={<Post />} /> */}\n                        <Route path=\"/post/\" element={<Post />} />\n                    </Routes>\n\n                </div>\n\n\n            );\n        }\n    }\n\n}\n\nexport default Post;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}